#CLI command to manually purge & optimize database. Make an SSH automation with this on n8n


docker exec --user www-data freshrss php -r "
set_time_limit(0);
require '/var/www/FreshRSS/cli/_cli.php';
\$user = 'yasinhasan';
cliInitUser(\$user);

echo '--- 1. Purging Old Articles ---' . PHP_EOL;
\$feedDAO = FreshRSS_Factory::createFeedDao();
\$totalPurged = 0;
foreach (\$feedDAO->listFeeds() as \$feed) {
    \$nb = \$feed->cleanOldEntries();
    if (\$nb > 0) {
        echo ' â€¢ Purged ' . \$nb . ' from: ' . \$feed->name() . PHP_EOL;
        \$totalPurged += \$nb;
    }
}
echo 'Purged ' . \$totalPurged . ' articles.' . PHP_EOL;

echo 'Updating feed counters...' . PHP_EOL;
\$feedDAO->updateCachedValues();

echo PHP_EOL . '--- 2. Optimizing Database ---' . PHP_EOL;
\$databaseDAO = FreshRSS_Factory::createDatabaseDAO(\$user);
if (\$databaseDAO->optimize()) {
    echo 'Database optimization successful.' . PHP_EOL;
} else {
    fwrite(STDERR, 'Database optimization failed!' . PHP_EOL);
    exit(1);
}
"